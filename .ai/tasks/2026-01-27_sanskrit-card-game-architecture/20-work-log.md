# Work Log

**Task ID:** [YYYY-MM-DD_task-name]
**Started:** [Date]
**Status:** [Not Started | In Progress | Blocked | Completed]

---

## Work Sessions

### Session 1: [Date Time]

#### Objectives for This Session
```
‚ñ° [Objective 1]
‚ñ° [Objective 2]
‚ñ° [Objective 3]
```

#### Work Completed
```
‚úì [Completed item 1]
‚úì [Completed item 2]
‚úì [Completed item 3]
```

**Files Modified:**
- `path/to/file1.ext` - [What changed]
- `path/to/file2.ext` - [What changed]

**Tests Added/Modified:**
- `path/to/test1.test.ext` - [What tests]

**Commands Run:**
```bash
npm test          # Result: 45/45 passing
npm run lint      # Result: 0 errors
```

#### In Progress
```
‚óã [Item being worked on]
```

#### Decisions Made
```
1. [Decision]: [Rationale]
2. [Decision]: [Rationale]
```

#### Issues Encountered
```
Issue: [Description]
- Attempted: [What was tried]
- Resolution: [How resolved] OR [Status: Still investigating]
```

#### Blockers
```
None currently
OR
‚ñ° [Blocker description]
  - Impact: [What it blocks]
  - Help needed: [What would unblock]
```

#### Next Steps
```
‚ñ° [Next task 1]
‚ñ° [Next task 2]
```

---

### Session 2: [Date Time]

#### Objectives for This Session
```
‚ñ° [Objective 1]
‚ñ° [Objective 2]
```

#### Work Completed
```
‚úì [Completed item 1]
‚úì [Completed item 2]
```

**Files Modified:**
- `path/to/file3.ext` - [What changed]

**Tests Added/Modified:**
- `path/to/test2.test.ext` - [What tests]

**Commands Run:**
```bash
npm test          # Result: 48/48 passing
```

#### In Progress
```
‚óã [Item being worked on]
```

#### Decisions Made
```
1. [Decision]: [Rationale]
```

#### Issues Encountered
```
None
OR
Issue: [Description]
- Resolution: [How resolved]
```

#### Blockers
```
None
OR
‚ñ° [Blocker description]
```

#### Next Steps
```
‚ñ° [Next task]
```

---

### Session N: [Date Time]

[Continue pattern for each work session...]

---

## Overall Progress Summary

### Completed Milestones
```
‚úì [Milestone 1] - [Date]
‚úì [Milestone 2] - [Date]
‚úì [Milestone 3] - [Date]
```

### Current Status
```
Phase: [Current phase of plan]
Progress: [X]% complete
Next Milestone: [What's next]
```

### Remaining Work
```
‚ñ° [Task 1]
‚ñ° [Task 2]
‚ñ° [Task 3]
```

---

## Deviations from Plan

### Changes to Original Plan
```
1. Original: [What was planned]
   Actual: [What was done instead]
   Rationale: [Why the change]

2. Original: [What was planned]
   Actual: [What was done instead]
   Rationale: [Why the change]
```

### Impact Assessment
```
- Timeline impact: [None | Minimal | Significant]
- Scope impact: [None | Expanded | Reduced]
- Quality impact: [None | Improved | Acceptable]
```

---

## Test Results

### Test Execution Summary
```
Total Tests: [X]
Passing: [X]
Failing: [X]
Skipped: [X]

Coverage: [X]%
- Overall: [X]%
- New code: [X]%
- Critical paths: [X]%
```

### Test Failures (if any)
```
1. Test: [Test name]
   File: [path/to/test]
   Issue: [Why failing]
   Status: [In progress | Fixed | Known issue]

2. Test: [Test name]
   ...
```

---

## Code Quality Metrics

### Linting Results
```
Errors: [X]
Warnings: [X]
Files checked: [X]
```

### Build Results
```
Build status: [Success | Failed]
Compilation time: [X]s
Warnings: [X]
```

### Performance Metrics
```
[Metric 1]: [Value] (target: [Target])
[Metric 2]: [Value] (target: [Target])
```

---

## Issues and Resolutions

### Issue 1: [Title]
**Discovered:** [Date]
**Severity:** [Low | Medium | High | Critical]

**Description:**
[What went wrong]

**Investigation:**
- [What was tried]
- [What was found]

**Resolution:**
[How it was fixed]

**Status:** [Resolved | Open | Deferred]

---

### Issue 2: [Title]
[Same format...]

---

## Technical Debt Identified

### New Technical Debt
```
1. [Debt item 1]
   - Location: [Where]
   - Reason: [Why incurred]
   - TODO: [How to address later]

2. [Debt item 2]
   - Location: [Where]
   - Reason: [Why incurred]
   - TODO: [How to address later]
```

### Addressed Technical Debt
```
‚úì [Debt item that was fixed]
  - Was: [Previous state]
  - Now: [Improved state]
```

---

## Learnings and Insights

### What Went Well
```
‚úì [Success 1]
‚úì [Success 2]
‚úì [Success 3]
```

### What Could Be Improved
```
‚ö† [Area for improvement 1]
‚ö† [Area for improvement 2]
```

### Knowledge Gained
```
- [New understanding 1]
- [New understanding 2]
- [Pattern/technique learned]
```

### Surprises and Discoveries
```
- [Unexpected finding 1]
- [Unexpected finding 2]
```

---

## Collaboration Notes

### Questions Asked
```
1. Q: [Question asked]
   A: [Answer received]
   Date: [When]

2. Q: [Question asked]
   A: [Answer received]
   Date: [When]
```

### Feedback Received
```
- [Feedback item 1] - [Date]
- [Feedback item 2] - [Date]
```

---

## Commits Made

### Commit History
```
1. [commit-hash]: [Commit message]
   Date: [Date]
   Files: [X files changed, +X lines, -X lines]

2. [commit-hash]: [Commit message]
   Date: [Date]
   Files: [X files changed, +X lines, -X lines]
```

---

## Work Log Summary

**Total Sessions:** [X]
**Total Time:** [X] hours (estimate)
**Files Modified:** [X]
**Files Created:** [X]
**Tests Added:** [X]
**Lines Added:** [~X]
**Lines Removed:** [~X]

**Overall Status:**
[Brief summary of where things stand]

---

## Usage Instructions

This template should be instantiated at: `.ai/tasks/YYYY-MM-DD_task-name/20-work-log.md`

**When to create:**
- At start of implementation
- Continue updating throughout work

**Who updates it:**
- Worker (primary)
- Orchestrator (monitors progress)

**Update frequency:**
- After each work session
- When significant progress made
- When blockers encountered
- At end of each day

**Key principles:**
- Be honest about progress
- Document decisions and rationale
- Note issues and resolutions
- Track deviations from plan
- Record learnings for future

---

## ‚ö†Ô∏è Work Log Rotation

**CRITICAL:** Work logs must be rotated when they exceed **15,000 tokens** to prevent Read tool failures.

### When to Rotate

Check file size periodically:
```bash
# Estimate tokens
WORDS=$(wc -w < 20-work-log.md)
TOKENS=$((WORDS * 4 / 3))  # 1 token ‚âà 0.75 words

if [ $TOKENS -gt 15000 ]; then
  echo "üö® MANDATORY rotation required: $TOKENS tokens"
elif [ $TOKENS -gt 12000 ]; then
  echo "‚ö†Ô∏è  Rotation recommended: $TOKENS tokens"
fi
```

**Rotation thresholds:**
- ‚ö†Ô∏è  **12,000+ tokens** - Rotation recommended
- üö® **15,000+ tokens** - Rotation MANDATORY
- ‚ùå **25,000+ tokens** - Read tool will fail

### How to Rotate

**STEP 1:** Move current log to archive
```bash
mv 20-work-log.md 20-work-log-archive-001.md
```

**STEP 2:** Create fresh log from template
```bash
cp ../../.ai-pack/templates/task-packet/20-work-log.md ./20-work-log.md
```

**STEP 3:** Add archive reference to new log
```bash
echo "" >> 20-work-log.md
echo "## Previous Work Logs" >> 20-work-log.md
echo "- [Archive 001](./20-work-log-archive-001.md) - Sessions 1-N" >> 20-work-log.md
```

**STEP 4:** Add continuation note to archive
```bash
echo "" >> 20-work-log-archive-001.md
echo "---" >> 20-work-log-archive-001.md
echo "## Continuation" >> 20-work-log-archive-001.md
echo "Work continues in: [20-work-log.md](./20-work-log.md)" >> 20-work-log-archive-001.md
```

**STEP 5:** Commit rotation
```bash
git add 20-work-log*.md
git commit -m "Rotate work log (exceeded token limit)"
```

### Archive Naming

```
20-work-log.md                    # Current (active)
20-work-log-archive-001.md        # First archive (oldest)
20-work-log-archive-002.md        # Second archive
20-work-log-archive-003.md        # Third archive (most recent)
```

### Archive References

**In current log:**
```markdown
## Previous Work Logs
- [Archive 003](./20-work-log-archive-003.md) - Sessions 21-30
- [Archive 002](./20-work-log-archive-002.md) - Sessions 11-20
- [Archive 001](./20-work-log-archive-001.md) - Sessions 1-10
```

**In each archive:**
```markdown
## Continuation
Work continues in: [20-work-log.md](./20-work-log.md)
OR
Next archive: [20-work-log-archive-002.md](./20-work-log-archive-002.md)
```

### Why Rotation Matters

**WITHOUT rotation:**
- ‚ùå Work log exceeds 25k token Read limit
- ‚ùå Orchestrator cannot monitor progress
- ‚ùå Coordination breaks down
- ‚ùå Background agents appear stuck

**WITH rotation:**
- ‚úÖ Work logs stay under Read limit
- ‚úÖ Orchestrator can read progress
- ‚úÖ Coordination continues smoothly
- ‚úÖ Historical context preserved

**See:** [Persistence Gates](../../.ai-pack/gates/10-persistence.md#12-work-log-size-management) for complete rotation rules
